webpackHotUpdate("main",{

/***/ "./src/index.ts":
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar PIXI = __webpack_require__(/*! pixi.js */ \"./node_modules/pixi.js/dist/esm/pixi.js\");\r\nvar app = new PIXI.Application({\r\n    width: 960, height: 550, backgroundColor: 0x1099bb, resolution: window.devicePixelRatio || 1,\r\n});\r\ndocument.body.appendChild(app.view);\r\nvar credits = 5000;\r\nvar betAmount = 1;\r\n// create a new background\r\nvar background = PIXI.Sprite.from('assets/BGSlotMachine.png');\r\nbackground.width = app.screen.width - 300;\r\nbackground.height = app.screen.height;\r\nbackground.x = (app.screen.width - background.width) / 2;\r\napp.stage.addChild(background);\r\n// create a new background slot machine\r\nvar barSlotMachine = PIXI.Sprite.from('assets/BarsSlotMachine.png');\r\nbarSlotMachine.width = app.screen.width - 300;\r\nbarSlotMachine.height = app.screen.height;\r\nbarSlotMachine.x = (app.screen.width - barSlotMachine.width) / 2;\r\napp.stage.addChild(barSlotMachine);\r\napp.loader\r\n    .add('assets/Symbol10.png', 'assets/Symbol10.png')\r\n    .add('assets/SymbolA.png', 'assets/SymbolA.png')\r\n    .add('assets/SymbolCaptain.png', 'assets/SymbolCaptain.png')\r\n    .add('assets/SymbolJ.png', 'assets/SymbolJ.png')\r\n    .add('assets/SymbolK.png', 'assets/SymbolK.png')\r\n    .add('assets/SymbolQ.png', 'assets/SymbolQ.png')\r\n    .add('assets/SymbolParrot.png', 'assets/SymbolParrot.png')\r\n    .add('assets/SymbolRum.png', 'assets/SymbolRum.png')\r\n    .add('assets/SymbolSkull.png', 'assets/SymbolSkull.png')\r\n    .add('assets/SymbolTreasure.png', 'assets/SymbolTreasure.png')\r\n    .load(onAssetsLoaded);\r\nvar REEL_WIDTH = (app.screen.width - 300) / 5;\r\nvar SYMBOL_SIZE = (app.screen.width - 300) / 5;\r\nfunction onAssetsLoaded() {\r\n    // Create different slot symbols.\r\n    var slotTextures = [\r\n        PIXI.Texture.from('assets/Symbol10.png'),\r\n        PIXI.Texture.from('assets/SymbolA.png'),\r\n    ];\r\n    // const names = [\"Symbol10\", \"SymbolA\", \"SymbolCaptain\", \"SymbolJ\", \"SymbolK\", \"SymbolQ\", \"SymbolParrot\", \"SymbolSkull\", \"SymbolTreasure\"];\r\n    // Build the reels\r\n    var reels = [];\r\n    var reelContainer = new PIXI.Container();\r\n    for (var i = 0; i < 5; i++) {\r\n        var rc = new PIXI.Container();\r\n        rc.x = (i * REEL_WIDTH) - 150;\r\n        reelContainer.addChild(rc);\r\n        var reel = {\r\n            container: rc,\r\n            symbols: [],\r\n            position: 0,\r\n            previousPosition: 0,\r\n            blur: new PIXI.filters.BlurFilter(),\r\n        };\r\n        reel.blur.blurX = 0;\r\n        reel.blur.blurY = 0;\r\n        rc.filters = [reel.blur];\r\n        // Build the symbols\r\n        for (var j = 0; j < 4; j++) {\r\n            var randomPick = Math.floor(Math.random() * slotTextures.length);\r\n            var symbol = new PIXI.Sprite(slotTextures[randomPick]);\r\n            // Scale the symbol to fit symbol area.\r\n            symbol.y = j * SYMBOL_SIZE;\r\n            symbol.scale.x = symbol.scale.y = Math.min(SYMBOL_SIZE / symbol.width, SYMBOL_SIZE / symbol.height);\r\n            symbol.x = Math.round((SYMBOL_SIZE - symbol.width) / 2);\r\n            reel.symbols.push(symbol);\r\n            rc.addChild(symbol);\r\n            // console.log(i, \") \", j, \") \",symbol.texture.textureCacheIds[0])\r\n        }\r\n        reels.push(reel);\r\n    }\r\n    console.log(reels);\r\n    app.stage.addChild(reelContainer);\r\n    // Build top & bottom covers and position reelContainer\r\n    var margin = (app.screen.height - SYMBOL_SIZE * 3) / 2;\r\n    reelContainer.y = margin;\r\n    reelContainer.x = Math.round(app.screen.width - REEL_WIDTH * 5);\r\n    var top = new PIXI.Graphics();\r\n    top.beginFill(0, 1);\r\n    top.drawRect(0, 0, app.screen.width, margin);\r\n    var bottom = new PIXI.Graphics();\r\n    bottom.beginFill(0, 1);\r\n    bottom.drawRect(0, SYMBOL_SIZE * 3 + margin, app.screen.width, margin);\r\n    // create a background header\r\n    var headerBg = PIXI.Sprite.from('assets/BGTopBar.png');\r\n    headerBg.height = 100;\r\n    headerBg.x = 0;\r\n    headerBg.y = 0;\r\n    top.addChild(headerBg);\r\n    // Add header logo\r\n    var headerLogo = PIXI.Sprite.from('assets/Logo.png');\r\n    headerLogo.height = 90;\r\n    headerLogo.width = 400;\r\n    headerLogo.x = Math.round((top.width - headerLogo.width) / 2);\r\n    headerLogo.y = Math.round((90 - headerLogo.height) / 2);\r\n    top.addChild(headerLogo);\r\n    // Add Credit showcase\r\n    var crediIcon = PIXI.Sprite.from('assets/Coins.png');\r\n    crediIcon.height = 50;\r\n    crediIcon.width = 50;\r\n    crediIcon.x = app.screen.width - 10 - crediIcon.width;\r\n    crediIcon.y = Math.round((margin - crediIcon.height) / 2);\r\n    top.addChild(crediIcon);\r\n    // Credit amount\r\n    var style = new PIXI.TextStyle({\r\n        fontFamily: 'Arial',\r\n        fontSize: 15,\r\n        // fontWeight: 'bold',\r\n        fill: \"#fff\",\r\n        dropShadow: false,\r\n    });\r\n    var creditLeftText = new PIXI.Text(credits.toString(), style);\r\n    creditLeftText.x = app.screen.width - 10 - crediIcon.width - creditLeftText.width;\r\n    creditLeftText.y = Math.round((margin - creditLeftText.height) / 2);\r\n    top.addChild(creditLeftText);\r\n    app.stage.addChild(top);\r\n    app.stage.addChild(bottom);\r\n    // create a background footer\r\n    var footerBg = PIXI.Sprite.from('assets/BGBottomBar.png');\r\n    footerBg.height = 100;\r\n    footerBg.x = 0;\r\n    footerBg.y = app.screen.height - footerBg.height;\r\n    bottom.addChild(footerBg);\r\n    // create a start button\r\n    var startBtn = new PIXI.Graphics();\r\n    startBtn.beginFill(0, 1);\r\n    startBtn = PIXI.Sprite.from('assets/ButtonStartActive.png');\r\n    startBtn.height = 70;\r\n    startBtn.width = 130;\r\n    startBtn.x = app.screen.width - 10 - startBtn.width;\r\n    startBtn.y = app.screen.height - 5 - startBtn.height;\r\n    bottom.addChild(startBtn);\r\n    // Max Bet Button\r\n    var maxBetBtn = new PIXI.Graphics();\r\n    maxBetBtn.beginFill(0, 1);\r\n    maxBetBtn = PIXI.Sprite.from('assets/ButtonMax.png');\r\n    maxBetBtn.height = 35;\r\n    maxBetBtn.width = 80;\r\n    maxBetBtn.x = app.screen.width - 300 - maxBetBtn.width;\r\n    maxBetBtn.y = app.screen.height - 20 - maxBetBtn.height;\r\n    bottom.addChild(maxBetBtn);\r\n    // Bet increase button\r\n    var incBetBtn = new PIXI.Graphics();\r\n    incBetBtn.beginFill(0, 1);\r\n    incBetBtn = PIXI.Sprite.from('assets/ButtonPlus.png');\r\n    incBetBtn.height = 35;\r\n    incBetBtn.width = 35;\r\n    incBetBtn.x = app.screen.width - 300 - incBetBtn.width - maxBetBtn.width;\r\n    incBetBtn.y = app.screen.height - 20 - incBetBtn.height;\r\n    bottom.addChild(incBetBtn);\r\n    // Bet decrease button\r\n    var decBetBtn = new PIXI.Graphics();\r\n    decBetBtn.beginFill(0, 1);\r\n    decBetBtn = PIXI.Sprite.from('assets/ButtonMinus.png');\r\n    decBetBtn.height = 35;\r\n    decBetBtn.width = 35;\r\n    decBetBtn.x = app.screen.width - 300 - decBetBtn.width - maxBetBtn.width - incBetBtn.width;\r\n    decBetBtn.y = app.screen.height - 20 - decBetBtn.height;\r\n    bottom.addChild(decBetBtn);\r\n    // Bet amount show\r\n    var style2 = new PIXI.TextStyle({\r\n        fontFamily: 'Arial',\r\n        fontSize: 25,\r\n        fontWeight: 'bold',\r\n        fill: \"#fff\",\r\n        dropShadow: false,\r\n    });\r\n    var betAmountShow = new PIXI.Text(betAmount.toString(), style2);\r\n    betAmountShow.x = app.screen.width - 300 - decBetBtn.width - maxBetBtn.width - decBetBtn.width - incBetBtn.width - betAmountShow.width;\r\n    betAmountShow.y = app.screen.height - 25 - betAmountShow.height;\r\n    bottom.addChild(betAmountShow);\r\n    // create a bet written text\r\n    var betText = PIXI.Sprite.from('assets/TextBet.png');\r\n    betText.height = 35;\r\n    betText.width = 60;\r\n    betText.x = app.screen.width - 300 - decBetBtn.width - maxBetBtn.width - decBetBtn.width - incBetBtn.width - betAmountShow.width - betText.width - 50;\r\n    betText.y = app.screen.height - 20 - betText.height;\r\n    bottom.addChild(betText);\r\n    // Set the interactivity.\r\n    startBtn.interactive = true;\r\n    startBtn.buttonMode = true;\r\n    startBtn.addListener('pointerdown', function () {\r\n        startPlay();\r\n    });\r\n    // Set bet max\r\n    maxBetBtn.interactive = true;\r\n    maxBetBtn.buttonMode = true;\r\n    maxBetBtn.addListener('pointerdown', function () {\r\n        if (credits > betAmount) {\r\n            betAmount = credits;\r\n            updateBetAmount(betAmount);\r\n        }\r\n    });\r\n    // Set bet max\r\n    incBetBtn.interactive = true;\r\n    incBetBtn.buttonMode = true;\r\n    incBetBtn.addListener('pointerdown', function () {\r\n        if (credits > betAmount) {\r\n            betAmount++;\r\n            updateBetAmount(betAmount);\r\n        }\r\n    });\r\n    // Set bet max\r\n    decBetBtn.interactive = true;\r\n    decBetBtn.buttonMode = true;\r\n    decBetBtn.addListener('pointerdown', function () {\r\n        if (betAmount > 1 && betAmount <= credits) {\r\n            betAmount--;\r\n            updateBetAmount(betAmount);\r\n        }\r\n    });\r\n    var running = false;\r\n    // Function to start playing.\r\n    function startPlay() {\r\n        if (running) {\r\n            startBtn = PIXI.Sprite.from('assets/ButtonStart.png');\r\n            return;\r\n        }\r\n        running = true;\r\n        credits -= betAmount;\r\n        updateCredit(credits);\r\n        for (var i = 0; i < reels.length; i++) {\r\n            var r = reels[i];\r\n            var extra = Math.floor(Math.random() * 3);\r\n            var target = r.position + 10 + i * 5 + extra;\r\n            var time = 2500 + i * 600 + extra * 600;\r\n            tweenTo(r, 'position', target, time, backout(0.5), null, i === reels.length - 1 ? reelsComplete : null);\r\n        }\r\n    }\r\n    // Reels done handler.\r\n    function reelsComplete() {\r\n        running = false;\r\n        if (credits <= 0) {\r\n            bottom.removeChild(startBtn);\r\n            startBtn = PIXI.Sprite.from('assets/ButtonStart.png');\r\n            startBtn.height = 70;\r\n            startBtn.width = 130;\r\n            startBtn.x = app.screen.width - 10 - startBtn.width;\r\n            startBtn.y = app.screen.height - 5 - startBtn.height;\r\n            bottom.addChild(startBtn);\r\n        }\r\n    }\r\n    function updateBetAmount(amount) {\r\n        bottom.removeChild(betAmountShow);\r\n        betAmountShow = new PIXI.Text(amount.toString(), style2);\r\n        betAmountShow.x = app.screen.width - 300 - decBetBtn.width - maxBetBtn.width - decBetBtn.width - incBetBtn.width - betAmountShow.width;\r\n        betAmountShow.y = app.screen.height - 25 - betAmountShow.height;\r\n        bottom.addChild(betAmountShow);\r\n    }\r\n    function updateCredit(amount) {\r\n        top.removeChild(creditLeftText);\r\n        creditLeftText = new PIXI.Text(amount.toString(), style);\r\n        creditLeftText.x = app.screen.width - 10 - crediIcon.width - creditLeftText.width;\r\n        creditLeftText.y = Math.round((margin - creditLeftText.height) / 2);\r\n        top.addChild(creditLeftText);\r\n    }\r\n    // Listen for animate update.\r\n    app.ticker.add(function (delta) {\r\n        // Update the slots.\r\n        for (var i = 0; i < reels.length; i++) {\r\n            var r = reels[i];\r\n            // Update blur filter y amount based on speed.\r\n            // This would be better if calculated with time in mind also. Now blur depends on frame rate.\r\n            r.blur.blurY = (r.position - r.previousPosition) * 8;\r\n            r.previousPosition = r.position;\r\n            // Update symbol positions on reel.\r\n            for (var j = 0; j < r.symbols.length; j++) {\r\n                var s = r.symbols[j];\r\n                var prevy = s.y;\r\n                s.y = ((r.position + j) % r.symbols.length) * SYMBOL_SIZE - SYMBOL_SIZE;\r\n                if (s.y < 0 && prevy > SYMBOL_SIZE) {\r\n                    // Detect going over and swap a texture.\r\n                    // This should in proper product be determined from some logical reel.\r\n                    s.texture = slotTextures[Math.floor(Math.random() * slotTextures.length)];\r\n                    s.scale.x = s.scale.y = Math.min(SYMBOL_SIZE / s.texture.width, SYMBOL_SIZE / s.texture.height);\r\n                    s.x = Math.round((SYMBOL_SIZE - s.width) / 2);\r\n                    // console.log(i, j, s)\r\n                }\r\n            }\r\n        }\r\n    });\r\n}\r\n// Very simple tweening utility function. This should be replaced with a proper tweening library in a real product.\r\nvar tweening = [];\r\nfunction tweenTo(object, property, target, time, easing, onchange, oncomplete) {\r\n    var tween = {\r\n        object: object,\r\n        property: property,\r\n        propertyBeginValue: object[property],\r\n        target: target,\r\n        easing: easing,\r\n        time: time,\r\n        change: onchange,\r\n        complete: oncomplete,\r\n        start: Date.now(),\r\n    };\r\n    tweening.push(tween);\r\n    console.log(tween);\r\n    return tween;\r\n}\r\n// Listen for animate update.\r\napp.ticker.add(function (delta) {\r\n    var now = Date.now();\r\n    var remove = [];\r\n    for (var i = 0; i < tweening.length; i++) {\r\n        var t = tweening[i];\r\n        var phase = Math.min(1, (now - t.start) / t.time);\r\n        t.object[t.property] = lerp(t.propertyBeginValue, t.target, t.easing(phase));\r\n        if (t.change)\r\n            t.change(t);\r\n        if (phase === 1) {\r\n            t.object[t.property] = t.target;\r\n            if (t.complete)\r\n                t.complete(t);\r\n            remove.push(t);\r\n        }\r\n    }\r\n    for (var i = 0; i < remove.length; i++) {\r\n        tweening.splice(tweening.indexOf(remove[i]), 1);\r\n    }\r\n});\r\n// Basic lerp funtion.\r\nfunction lerp(a1, a2, t) {\r\n    return a1 * (1 - t) + a2 * t;\r\n}\r\n// Backout function from tweenjs.\r\n// https://github.com/CreateJS/TweenJS/blob/master/src/tweenjs/Ease.js\r\nfunction backout(amount) {\r\n    return function (t) { return (--t * t * ((amount + 1) * t + amount) + 1); };\r\n}\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvaW5kZXgudHMuanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4vc3JjL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIFBJWEkgZnJvbSAncGl4aS5qcyc7XG5cbmNvbnN0IGFwcCA9IG5ldyBQSVhJLkFwcGxpY2F0aW9uKHtcbiAgICB3aWR0aDogOTYwLCBoZWlnaHQ6IDU1MCwgYmFja2dyb3VuZENvbG9yOiAweDEwOTliYiwgcmVzb2x1dGlvbjogd2luZG93LmRldmljZVBpeGVsUmF0aW8gfHwgMSxcbn0pO1xuZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhcHAudmlldyk7XG5cbmxldCBjcmVkaXRzOm51bWJlciA9IDUwMDA7XG5sZXQgYmV0QW1vdW50Om51bWJlciA9IDE7XG5cbi8vIGNyZWF0ZSBhIG5ldyBiYWNrZ3JvdW5kXG5jb25zdCBiYWNrZ3JvdW5kID0gUElYSS5TcHJpdGUuZnJvbSgnYXNzZXRzL0JHU2xvdE1hY2hpbmUucG5nJyk7XG5iYWNrZ3JvdW5kLndpZHRoID0gYXBwLnNjcmVlbi53aWR0aCAtIDMwMDtcbmJhY2tncm91bmQuaGVpZ2h0ID0gYXBwLnNjcmVlbi5oZWlnaHQ7XG5iYWNrZ3JvdW5kLnggPSAoYXBwLnNjcmVlbi53aWR0aCAtIGJhY2tncm91bmQud2lkdGgpIC8gMjtcbmFwcC5zdGFnZS5hZGRDaGlsZChiYWNrZ3JvdW5kKTtcblxuLy8gY3JlYXRlIGEgbmV3IGJhY2tncm91bmQgc2xvdCBtYWNoaW5lXG5jb25zdCBiYXJTbG90TWFjaGluZSA9IFBJWEkuU3ByaXRlLmZyb20oJ2Fzc2V0cy9CYXJzU2xvdE1hY2hpbmUucG5nJyk7XG5iYXJTbG90TWFjaGluZS53aWR0aCA9IGFwcC5zY3JlZW4ud2lkdGggLSAzMDA7XG5iYXJTbG90TWFjaGluZS5oZWlnaHQgPSBhcHAuc2NyZWVuLmhlaWdodDtcbmJhclNsb3RNYWNoaW5lLnggPSAoYXBwLnNjcmVlbi53aWR0aCAtIGJhclNsb3RNYWNoaW5lLndpZHRoKSAvIDI7XG5hcHAuc3RhZ2UuYWRkQ2hpbGQoYmFyU2xvdE1hY2hpbmUpO1xuXG5hcHAubG9hZGVyXG4gICAgLmFkZCgnYXNzZXRzL1N5bWJvbDEwLnBuZycsICdhc3NldHMvU3ltYm9sMTAucG5nJylcbiAgICAuYWRkKCdhc3NldHMvU3ltYm9sQS5wbmcnLCAnYXNzZXRzL1N5bWJvbEEucG5nJylcbiAgICAuYWRkKCdhc3NldHMvU3ltYm9sQ2FwdGFpbi5wbmcnLCAnYXNzZXRzL1N5bWJvbENhcHRhaW4ucG5nJylcbiAgICAuYWRkKCdhc3NldHMvU3ltYm9sSi5wbmcnLCAnYXNzZXRzL1N5bWJvbEoucG5nJylcbiAgICAuYWRkKCdhc3NldHMvU3ltYm9sSy5wbmcnLCAnYXNzZXRzL1N5bWJvbEsucG5nJylcbiAgICAuYWRkKCdhc3NldHMvU3ltYm9sUS5wbmcnLCAnYXNzZXRzL1N5bWJvbFEucG5nJylcbiAgICAuYWRkKCdhc3NldHMvU3ltYm9sUGFycm90LnBuZycsICdhc3NldHMvU3ltYm9sUGFycm90LnBuZycpXG4gICAgLmFkZCgnYXNzZXRzL1N5bWJvbFJ1bS5wbmcnLCAnYXNzZXRzL1N5bWJvbFJ1bS5wbmcnKVxuICAgIC5hZGQoJ2Fzc2V0cy9TeW1ib2xTa3VsbC5wbmcnLCAnYXNzZXRzL1N5bWJvbFNrdWxsLnBuZycpXG4gICAgLmFkZCgnYXNzZXRzL1N5bWJvbFRyZWFzdXJlLnBuZycsICdhc3NldHMvU3ltYm9sVHJlYXN1cmUucG5nJylcbiAgICAubG9hZChvbkFzc2V0c0xvYWRlZCk7XG5cbmNvbnN0IFJFRUxfV0lEVEggPSAoYXBwLnNjcmVlbi53aWR0aCAtIDMwMCkvNTtcbmNvbnN0IFNZTUJPTF9TSVpFID0gKGFwcC5zY3JlZW4ud2lkdGggLSAzMDApLzU7XG5cbmZ1bmN0aW9uIG9uQXNzZXRzTG9hZGVkKCkge1xuICAgIC8vIENyZWF0ZSBkaWZmZXJlbnQgc2xvdCBzeW1ib2xzLlxuICAgIGNvbnN0IHNsb3RUZXh0dXJlcyA9IFtcbiAgICAgICAgUElYSS5UZXh0dXJlLmZyb20oJ2Fzc2V0cy9TeW1ib2wxMC5wbmcnKSxcbiAgICAgICAgUElYSS5UZXh0dXJlLmZyb20oJ2Fzc2V0cy9TeW1ib2xBLnBuZycpLFxuICAgICAgICAvLyBQSVhJLlRleHR1cmUuZnJvbSgnYXNzZXRzL1N5bWJvbENhcHRhaW4ucG5nJyksXG4gICAgICAgIC8vIFBJWEkuVGV4dHVyZS5mcm9tKCdhc3NldHMvU3ltYm9sSi5wbmcnKSxcbiAgICAgICAgLy8gUElYSS5UZXh0dXJlLmZyb20oJ2Fzc2V0cy9TeW1ib2xLLnBuZycpLFxuICAgICAgICAvLyBQSVhJLlRleHR1cmUuZnJvbSgnYXNzZXRzL1N5bWJvbFEucG5nJyksXG4gICAgICAgIC8vIFBJWEkuVGV4dHVyZS5mcm9tKCdhc3NldHMvU3ltYm9sUGFycm90LnBuZycpLFxuICAgICAgICAvLyAvLyBQSVhJLlRleHR1cmUuZnJvbSgnYXNzZXRzL1N5bWJvbFJ1bS5wbmcnKSxcbiAgICAgICAgLy8gUElYSS5UZXh0dXJlLmZyb20oJ2Fzc2V0cy9TeW1ib2xTa3VsbC5wbmcnKSxcbiAgICAgICAgLy8gUElYSS5UZXh0dXJlLmZyb20oJ2Fzc2V0cy9TeW1ib2xUcmVhc3VyZS5wbmcnKVxuICAgIF07XG5cbiAgICAvLyBjb25zdCBuYW1lcyA9IFtcIlN5bWJvbDEwXCIsIFwiU3ltYm9sQVwiLCBcIlN5bWJvbENhcHRhaW5cIiwgXCJTeW1ib2xKXCIsIFwiU3ltYm9sS1wiLCBcIlN5bWJvbFFcIiwgXCJTeW1ib2xQYXJyb3RcIiwgXCJTeW1ib2xTa3VsbFwiLCBcIlN5bWJvbFRyZWFzdXJlXCJdO1xuXG4gICAgLy8gQnVpbGQgdGhlIHJlZWxzXG4gICAgY29uc3QgcmVlbHM6YW55ID0gW107XG4gICAgY29uc3QgcmVlbENvbnRhaW5lciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNTsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHJjID0gbmV3IFBJWEkuQ29udGFpbmVyKCk7XG4gICAgICAgIHJjLnggPSAoaSAqIFJFRUxfV0lEVEgpIC0gMTUwO1xuICAgICAgICByZWVsQ29udGFpbmVyLmFkZENoaWxkKHJjKTtcblxuICAgICAgICBjb25zdCByZWVsOmFueSA9IHtcbiAgICAgICAgICAgIGNvbnRhaW5lcjogcmMsXG4gICAgICAgICAgICBzeW1ib2xzOiBbXSxcbiAgICAgICAgICAgIHBvc2l0aW9uOiAwLFxuICAgICAgICAgICAgcHJldmlvdXNQb3NpdGlvbjogMCxcbiAgICAgICAgICAgIGJsdXI6IG5ldyBQSVhJLmZpbHRlcnMuQmx1ckZpbHRlcigpLFxuICAgICAgICB9O1xuICAgICAgICByZWVsLmJsdXIuYmx1clggPSAwO1xuICAgICAgICByZWVsLmJsdXIuYmx1clkgPSAwO1xuICAgICAgICByYy5maWx0ZXJzID0gW3JlZWwuYmx1cl07XG5cbiAgICAgICAgLy8gQnVpbGQgdGhlIHN5bWJvbHNcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCA0OyBqKyspIHtcbiAgICAgICAgICAgIGxldCByYW5kb21QaWNrID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogc2xvdFRleHR1cmVzLmxlbmd0aCk7XG4gICAgICAgICAgICBjb25zdCBzeW1ib2w6YW55ID0gbmV3IFBJWEkuU3ByaXRlKHNsb3RUZXh0dXJlc1tyYW5kb21QaWNrXSk7XG4gICAgICAgICAgICAvLyBTY2FsZSB0aGUgc3ltYm9sIHRvIGZpdCBzeW1ib2wgYXJlYS5cbiAgICAgICAgICAgIHN5bWJvbC55ID0gaiAqIFNZTUJPTF9TSVpFO1xuICAgICAgICAgICAgc3ltYm9sLnNjYWxlLnggPSBzeW1ib2wuc2NhbGUueSA9IE1hdGgubWluKFNZTUJPTF9TSVpFIC8gc3ltYm9sLndpZHRoLCBTWU1CT0xfU0laRSAvIHN5bWJvbC5oZWlnaHQpO1xuICAgICAgICAgICAgc3ltYm9sLnggPSBNYXRoLnJvdW5kKChTWU1CT0xfU0laRSAtIHN5bWJvbC53aWR0aCkgLyAyKTtcbiAgICAgICAgICAgIHJlZWwuc3ltYm9scy5wdXNoKHN5bWJvbCk7XG4gICAgICAgICAgICByYy5hZGRDaGlsZChzeW1ib2wpO1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coaSwgXCIpIFwiLCBqLCBcIikgXCIsc3ltYm9sLnRleHR1cmUudGV4dHVyZUNhY2hlSWRzWzBdKVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZWVscy5wdXNoKHJlZWwpO1xuICAgIH1cbiAgICBjb25zb2xlLmxvZyhyZWVscylcbiAgICBcbiAgICBhcHAuc3RhZ2UuYWRkQ2hpbGQocmVlbENvbnRhaW5lcik7XG5cbiAgICAvLyBCdWlsZCB0b3AgJiBib3R0b20gY292ZXJzIGFuZCBwb3NpdGlvbiByZWVsQ29udGFpbmVyXG4gICAgY29uc3QgbWFyZ2luID0gKGFwcC5zY3JlZW4uaGVpZ2h0IC0gU1lNQk9MX1NJWkUgKiAzKSAvIDI7XG4gICAgcmVlbENvbnRhaW5lci55ID0gbWFyZ2luO1xuICAgIHJlZWxDb250YWluZXIueCA9IE1hdGgucm91bmQoYXBwLnNjcmVlbi53aWR0aCAtIFJFRUxfV0lEVEggKiA1KTtcbiAgICBjb25zdCB0b3AgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuICAgIHRvcC5iZWdpbkZpbGwoMCwgMSk7XG4gICAgdG9wLmRyYXdSZWN0KDAsIDAsIGFwcC5zY3JlZW4ud2lkdGgsIG1hcmdpbik7XG4gICAgXG4gICAgY29uc3QgYm90dG9tOmFueSA9IG5ldyBQSVhJLkdyYXBoaWNzKCk7XG4gICAgYm90dG9tLmJlZ2luRmlsbCgwLCAxKTtcbiAgICBib3R0b20uZHJhd1JlY3QoMCwgU1lNQk9MX1NJWkUgKiAzICsgbWFyZ2luLCBhcHAuc2NyZWVuLndpZHRoLCBtYXJnaW4pO1xuXG4gICAgLy8gY3JlYXRlIGEgYmFja2dyb3VuZCBoZWFkZXJcbiAgICBjb25zdCBoZWFkZXJCZyA9IFBJWEkuU3ByaXRlLmZyb20oJ2Fzc2V0cy9CR1RvcEJhci5wbmcnKTtcbiAgICBoZWFkZXJCZy5oZWlnaHQgPSAxMDA7IFxuICAgIGhlYWRlckJnLnggPSAwO1xuICAgIGhlYWRlckJnLnkgPSAwO1xuICAgIHRvcC5hZGRDaGlsZChoZWFkZXJCZyk7XG5cblxuICAgIC8vIEFkZCBoZWFkZXIgbG9nb1xuICAgIGNvbnN0IGhlYWRlckxvZ28gPSBQSVhJLlNwcml0ZS5mcm9tKCdhc3NldHMvTG9nby5wbmcnKTtcbiAgICBoZWFkZXJMb2dvLmhlaWdodCA9IDkwOyBcbiAgICBoZWFkZXJMb2dvLndpZHRoID0gNDAwOyBcbiAgICBoZWFkZXJMb2dvLnggPSBNYXRoLnJvdW5kKCh0b3Aud2lkdGggLSBoZWFkZXJMb2dvLndpZHRoKSAvIDIpO1xuICAgIGhlYWRlckxvZ28ueSA9IE1hdGgucm91bmQoKDkwIC0gaGVhZGVyTG9nby5oZWlnaHQpIC8gMik7XG4gICAgdG9wLmFkZENoaWxkKGhlYWRlckxvZ28pO1xuXG4gICAgLy8gQWRkIENyZWRpdCBzaG93Y2FzZVxuICAgIGNvbnN0IGNyZWRpSWNvbiA9IFBJWEkuU3ByaXRlLmZyb20oJ2Fzc2V0cy9Db2lucy5wbmcnKTtcbiAgICBjcmVkaUljb24uaGVpZ2h0ID0gNTA7IFxuICAgIGNyZWRpSWNvbi53aWR0aCA9IDUwOyBcbiAgICBjcmVkaUljb24ueCA9IGFwcC5zY3JlZW4ud2lkdGggLSAxMCAtIGNyZWRpSWNvbi53aWR0aDtcbiAgICBjcmVkaUljb24ueSA9IE1hdGgucm91bmQoKG1hcmdpbiAtIGNyZWRpSWNvbi5oZWlnaHQpIC8gMik7XG4gICAgdG9wLmFkZENoaWxkKGNyZWRpSWNvbik7XG5cbiAgICAvLyBDcmVkaXQgYW1vdW50XG4gICAgY29uc3Qgc3R5bGUgPSBuZXcgUElYSS5UZXh0U3R5bGUoe1xuICAgICAgICBmb250RmFtaWx5OiAnQXJpYWwnLFxuICAgICAgICBmb250U2l6ZTogMTUsXG4gICAgICAgIC8vIGZvbnRXZWlnaHQ6ICdib2xkJyxcbiAgICAgICAgZmlsbDogXCIjZmZmXCIsXG4gICAgICAgIGRyb3BTaGFkb3c6IGZhbHNlLFxuICAgIH0pO1xuICAgIGxldCBjcmVkaXRMZWZ0VGV4dCA9IG5ldyBQSVhJLlRleHQoY3JlZGl0cy50b1N0cmluZygpLCBzdHlsZSk7XG4gICAgY3JlZGl0TGVmdFRleHQueCA9IGFwcC5zY3JlZW4ud2lkdGggLSAxMCAtIGNyZWRpSWNvbi53aWR0aCAgLSBjcmVkaXRMZWZ0VGV4dC53aWR0aDtcbiAgICBjcmVkaXRMZWZ0VGV4dC55ID0gTWF0aC5yb3VuZCgobWFyZ2luIC0gY3JlZGl0TGVmdFRleHQuaGVpZ2h0KSAvIDIpO1xuICAgIHRvcC5hZGRDaGlsZChjcmVkaXRMZWZ0VGV4dCk7XG5cbiAgICBhcHAuc3RhZ2UuYWRkQ2hpbGQodG9wKTtcbiAgICBhcHAuc3RhZ2UuYWRkQ2hpbGQoYm90dG9tKTtcblxuICAgIC8vIGNyZWF0ZSBhIGJhY2tncm91bmQgZm9vdGVyXG4gICAgY29uc3QgZm9vdGVyQmcgPSBQSVhJLlNwcml0ZS5mcm9tKCdhc3NldHMvQkdCb3R0b21CYXIucG5nJyk7XG4gICAgZm9vdGVyQmcuaGVpZ2h0ID0gMTAwOyBcbiAgICBmb290ZXJCZy54ID0gMDtcbiAgICBmb290ZXJCZy55ID0gYXBwLnNjcmVlbi5oZWlnaHQgLSBmb290ZXJCZy5oZWlnaHQ7XG4gICAgYm90dG9tLmFkZENoaWxkKGZvb3RlckJnKTtcblxuICAgIC8vIGNyZWF0ZSBhIHN0YXJ0IGJ1dHRvblxuICAgIGxldCBzdGFydEJ0bjphbnkgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuICAgIHN0YXJ0QnRuLmJlZ2luRmlsbCgwLCAxKTtcbiAgICBzdGFydEJ0biA9IFBJWEkuU3ByaXRlLmZyb20oJ2Fzc2V0cy9CdXR0b25TdGFydEFjdGl2ZS5wbmcnKTtcbiAgICBzdGFydEJ0bi5oZWlnaHQgPSA3MDsgXG4gICAgc3RhcnRCdG4ud2lkdGggPSAxMzA7XG4gICAgc3RhcnRCdG4ueCA9IGFwcC5zY3JlZW4ud2lkdGggLSAxMCAtIHN0YXJ0QnRuLndpZHRoO1xuICAgIHN0YXJ0QnRuLnkgPSBhcHAuc2NyZWVuLmhlaWdodCAtIDUgLSBzdGFydEJ0bi5oZWlnaHQ7XG4gICAgYm90dG9tLmFkZENoaWxkKHN0YXJ0QnRuKTtcblxuICAgIC8vIE1heCBCZXQgQnV0dG9uXG4gICAgbGV0IG1heEJldEJ0bjphbnkgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuICAgIG1heEJldEJ0bi5iZWdpbkZpbGwoMCwgMSk7XG4gICAgbWF4QmV0QnRuID0gUElYSS5TcHJpdGUuZnJvbSgnYXNzZXRzL0J1dHRvbk1heC5wbmcnKTtcbiAgICBtYXhCZXRCdG4uaGVpZ2h0ID0gMzU7IFxuICAgIG1heEJldEJ0bi53aWR0aCA9IDgwO1xuICAgIG1heEJldEJ0bi54ID0gYXBwLnNjcmVlbi53aWR0aCAtIDMwMCAtIG1heEJldEJ0bi53aWR0aDtcbiAgICBtYXhCZXRCdG4ueSA9IGFwcC5zY3JlZW4uaGVpZ2h0IC0gMjAgLSBtYXhCZXRCdG4uaGVpZ2h0O1xuICAgIGJvdHRvbS5hZGRDaGlsZChtYXhCZXRCdG4pO1xuXG4gICAgLy8gQmV0IGluY3JlYXNlIGJ1dHRvblxuICAgIGxldCBpbmNCZXRCdG46YW55ID0gbmV3IFBJWEkuR3JhcGhpY3MoKTtcbiAgICBpbmNCZXRCdG4uYmVnaW5GaWxsKDAsIDEpO1xuICAgIGluY0JldEJ0biA9IFBJWEkuU3ByaXRlLmZyb20oJ2Fzc2V0cy9CdXR0b25QbHVzLnBuZycpO1xuICAgIGluY0JldEJ0bi5oZWlnaHQgPSAzNTsgXG4gICAgaW5jQmV0QnRuLndpZHRoID0gMzU7XG4gICAgaW5jQmV0QnRuLnggPSBhcHAuc2NyZWVuLndpZHRoIC0gMzAwIC0gaW5jQmV0QnRuLndpZHRoIC0gbWF4QmV0QnRuLndpZHRoO1xuICAgIGluY0JldEJ0bi55ID0gYXBwLnNjcmVlbi5oZWlnaHQgLSAyMCAtIGluY0JldEJ0bi5oZWlnaHQ7XG4gICAgYm90dG9tLmFkZENoaWxkKGluY0JldEJ0bik7ICBcbiAgICBcbiAgICAvLyBCZXQgZGVjcmVhc2UgYnV0dG9uXG4gICAgbGV0IGRlY0JldEJ0bjphbnkgPSBuZXcgUElYSS5HcmFwaGljcygpO1xuICAgIGRlY0JldEJ0bi5iZWdpbkZpbGwoMCwgMSk7XG4gICAgZGVjQmV0QnRuID0gUElYSS5TcHJpdGUuZnJvbSgnYXNzZXRzL0J1dHRvbk1pbnVzLnBuZycpO1xuICAgIGRlY0JldEJ0bi5oZWlnaHQgPSAzNTsgXG4gICAgZGVjQmV0QnRuLndpZHRoID0gMzU7XG4gICAgZGVjQmV0QnRuLnggPSBhcHAuc2NyZWVuLndpZHRoIC0gMzAwIC0gZGVjQmV0QnRuLndpZHRoIC0gbWF4QmV0QnRuLndpZHRoIC0gaW5jQmV0QnRuLndpZHRoO1xuICAgIGRlY0JldEJ0bi55ID0gYXBwLnNjcmVlbi5oZWlnaHQgLSAyMCAtIGRlY0JldEJ0bi5oZWlnaHQ7XG4gICAgYm90dG9tLmFkZENoaWxkKGRlY0JldEJ0bik7IFxuXG4gICAgLy8gQmV0IGFtb3VudCBzaG93XG4gICAgY29uc3Qgc3R5bGUyID0gbmV3IFBJWEkuVGV4dFN0eWxlKHtcbiAgICAgICAgZm9udEZhbWlseTogJ0FyaWFsJyxcbiAgICAgICAgZm9udFNpemU6IDI1LFxuICAgICAgICBmb250V2VpZ2h0OiAnYm9sZCcsXG4gICAgICAgIGZpbGw6IFwiI2ZmZlwiLFxuICAgICAgICBkcm9wU2hhZG93OiBmYWxzZSxcbiAgICB9KTtcbiAgICBsZXQgYmV0QW1vdW50U2hvdyA9IG5ldyBQSVhJLlRleHQoYmV0QW1vdW50LnRvU3RyaW5nKCksIHN0eWxlMik7XG4gICAgYmV0QW1vdW50U2hvdy54ID0gYXBwLnNjcmVlbi53aWR0aCAtIDMwMCAtIGRlY0JldEJ0bi53aWR0aCAtIG1heEJldEJ0bi53aWR0aCAtIGRlY0JldEJ0bi53aWR0aCAtIGluY0JldEJ0bi53aWR0aCAtIGJldEFtb3VudFNob3cud2lkdGg7XG4gICAgYmV0QW1vdW50U2hvdy55ID0gYXBwLnNjcmVlbi5oZWlnaHQgLSAyNSAtIGJldEFtb3VudFNob3cuaGVpZ2h0O1xuICAgIGJvdHRvbS5hZGRDaGlsZChiZXRBbW91bnRTaG93KTtcblxuICAgIC8vIGNyZWF0ZSBhIGJldCB3cml0dGVuIHRleHRcbiAgICBjb25zdCBiZXRUZXh0ID0gUElYSS5TcHJpdGUuZnJvbSgnYXNzZXRzL1RleHRCZXQucG5nJyk7XG4gICAgYmV0VGV4dC5oZWlnaHQgPSAzNTsgXG4gICAgYmV0VGV4dC53aWR0aCA9IDYwO1xuICAgIGJldFRleHQueCA9IGFwcC5zY3JlZW4ud2lkdGggLSAzMDAgLSBkZWNCZXRCdG4ud2lkdGggLSBtYXhCZXRCdG4ud2lkdGggLSBkZWNCZXRCdG4ud2lkdGggLSBpbmNCZXRCdG4ud2lkdGggLSBiZXRBbW91bnRTaG93LndpZHRoIC0gYmV0VGV4dC53aWR0aCAtIDUwO1xuICAgIGJldFRleHQueSA9IGFwcC5zY3JlZW4uaGVpZ2h0IC0gMjAgLSBiZXRUZXh0LmhlaWdodDtcbiAgICBib3R0b20uYWRkQ2hpbGQoYmV0VGV4dCk7XG4gICBcblxuICAgIC8vIFNldCB0aGUgaW50ZXJhY3Rpdml0eS5cbiAgICBzdGFydEJ0bi5pbnRlcmFjdGl2ZSA9IHRydWU7XG4gICAgc3RhcnRCdG4uYnV0dG9uTW9kZSA9IHRydWU7XG4gICAgc3RhcnRCdG4uYWRkTGlzdGVuZXIoJ3BvaW50ZXJkb3duJywgKCkgPT4ge1xuICAgICAgICBzdGFydFBsYXkoKTtcbiAgICB9KTtcblxuICAgIC8vIFNldCBiZXQgbWF4XG4gICAgbWF4QmV0QnRuLmludGVyYWN0aXZlID0gdHJ1ZTtcbiAgICBtYXhCZXRCdG4uYnV0dG9uTW9kZSA9IHRydWU7XG4gICAgbWF4QmV0QnRuLmFkZExpc3RlbmVyKCdwb2ludGVyZG93bicsICgpID0+IHtcbiAgICAgICAgaWYoY3JlZGl0cyA+IGJldEFtb3VudCl7XG4gICAgICAgICAgICBiZXRBbW91bnQgPSBjcmVkaXRzO1xuICAgICAgICAgICAgdXBkYXRlQmV0QW1vdW50KGJldEFtb3VudCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFNldCBiZXQgbWF4XG4gICAgaW5jQmV0QnRuLmludGVyYWN0aXZlID0gdHJ1ZTtcbiAgICBpbmNCZXRCdG4uYnV0dG9uTW9kZSA9IHRydWU7XG4gICAgaW5jQmV0QnRuLmFkZExpc3RlbmVyKCdwb2ludGVyZG93bicsICgpID0+IHtcbiAgICAgICAgaWYoY3JlZGl0cyA+IGJldEFtb3VudCl7XG4gICAgICAgICAgICBiZXRBbW91bnQrKztcbiAgICAgICAgICAgIHVwZGF0ZUJldEFtb3VudChiZXRBbW91bnQpO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBTZXQgYmV0IG1heFxuICAgIGRlY0JldEJ0bi5pbnRlcmFjdGl2ZSA9IHRydWU7XG4gICAgZGVjQmV0QnRuLmJ1dHRvbk1vZGUgPSB0cnVlO1xuICAgIGRlY0JldEJ0bi5hZGRMaXN0ZW5lcigncG9pbnRlcmRvd24nLCAoKSA9PiB7XG4gICAgICAgIGlmKGJldEFtb3VudCA+IDEgJiYgYmV0QW1vdW50IDw9IGNyZWRpdHMpe1xuICAgICAgICAgICAgYmV0QW1vdW50LS07XG4gICAgICAgICAgICB1cGRhdGVCZXRBbW91bnQoYmV0QW1vdW50KTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgbGV0IHJ1bm5pbmcgPSBmYWxzZTtcblxuICAgIC8vIEZ1bmN0aW9uIHRvIHN0YXJ0IHBsYXlpbmcuXG4gICAgZnVuY3Rpb24gc3RhcnRQbGF5KCkge1xuICAgICAgICBpZiAocnVubmluZykge1xuICAgICAgICAgICAgc3RhcnRCdG4gPSBQSVhJLlNwcml0ZS5mcm9tKCdhc3NldHMvQnV0dG9uU3RhcnQucG5nJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgcnVubmluZyA9IHRydWU7XG5cbiAgICAgICAgY3JlZGl0cyAtPSBiZXRBbW91bnQ7XG4gICAgICAgIHVwZGF0ZUNyZWRpdChjcmVkaXRzKTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlZWxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCByID0gcmVlbHNbaV07XG4gICAgICAgICAgICBjb25zdCBleHRyYSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDMpO1xuICAgICAgICAgICAgY29uc3QgdGFyZ2V0ID0gci5wb3NpdGlvbiArIDEwICsgaSAqIDUgKyBleHRyYTtcbiAgICAgICAgICAgIGNvbnN0IHRpbWUgPSAyNTAwICsgaSAqIDYwMCArIGV4dHJhICogNjAwO1xuICAgICAgICAgICAgdHdlZW5UbyhyLCAncG9zaXRpb24nLCB0YXJnZXQsIHRpbWUsIGJhY2tvdXQoMC41KSwgbnVsbCwgaSA9PT0gcmVlbHMubGVuZ3RoIC0gMSA/IHJlZWxzQ29tcGxldGUgOiBudWxsKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIFJlZWxzIGRvbmUgaGFuZGxlci5cbiAgICBmdW5jdGlvbiByZWVsc0NvbXBsZXRlKCkge1xuICAgICAgICBydW5uaW5nID0gZmFsc2U7XG4gICAgICAgIGlmKGNyZWRpdHMgPD0gMCl7XG4gICAgICAgICAgICBib3R0b20ucmVtb3ZlQ2hpbGQoc3RhcnRCdG4pO1xuICAgICAgICAgICAgc3RhcnRCdG4gPSBQSVhJLlNwcml0ZS5mcm9tKCdhc3NldHMvQnV0dG9uU3RhcnQucG5nJyk7XG4gICAgICAgICAgICBzdGFydEJ0bi5oZWlnaHQgPSA3MDsgXG4gICAgICAgICAgICBzdGFydEJ0bi53aWR0aCA9IDEzMDtcbiAgICAgICAgICAgIHN0YXJ0QnRuLnggPSBhcHAuc2NyZWVuLndpZHRoIC0gMTAgLSBzdGFydEJ0bi53aWR0aDtcbiAgICAgICAgICAgIHN0YXJ0QnRuLnkgPSBhcHAuc2NyZWVuLmhlaWdodCAtIDUgLSBzdGFydEJ0bi5oZWlnaHQ7XG4gICAgICAgICAgICBib3R0b20uYWRkQ2hpbGQoc3RhcnRCdG4pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdXBkYXRlQmV0QW1vdW50KGFtb3VudDpudW1iZXIpe1xuICAgICAgICBib3R0b20ucmVtb3ZlQ2hpbGQoYmV0QW1vdW50U2hvdyk7XG4gICAgICAgIGJldEFtb3VudFNob3cgPSBuZXcgUElYSS5UZXh0KGFtb3VudC50b1N0cmluZygpLCBzdHlsZTIpO1xuICAgICAgICBiZXRBbW91bnRTaG93LnggPSBhcHAuc2NyZWVuLndpZHRoIC0gMzAwIC0gZGVjQmV0QnRuLndpZHRoIC0gbWF4QmV0QnRuLndpZHRoIC0gZGVjQmV0QnRuLndpZHRoIC0gaW5jQmV0QnRuLndpZHRoIC0gYmV0QW1vdW50U2hvdy53aWR0aDtcbiAgICAgICAgYmV0QW1vdW50U2hvdy55ID0gYXBwLnNjcmVlbi5oZWlnaHQgLSAyNSAtIGJldEFtb3VudFNob3cuaGVpZ2h0O1xuICAgICAgICBib3R0b20uYWRkQ2hpbGQoYmV0QW1vdW50U2hvdyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdXBkYXRlQ3JlZGl0KGFtb3VudDpudW1iZXIpe1xuICAgICAgICB0b3AucmVtb3ZlQ2hpbGQoY3JlZGl0TGVmdFRleHQpO1xuICAgICAgICBjcmVkaXRMZWZ0VGV4dCA9IG5ldyBQSVhJLlRleHQoYW1vdW50LnRvU3RyaW5nKCksIHN0eWxlKTtcbiAgICAgICAgY3JlZGl0TGVmdFRleHQueCA9IGFwcC5zY3JlZW4ud2lkdGggLSAxMCAtIGNyZWRpSWNvbi53aWR0aCAgLSBjcmVkaXRMZWZ0VGV4dC53aWR0aDtcbiAgICAgICAgY3JlZGl0TGVmdFRleHQueSA9IE1hdGgucm91bmQoKG1hcmdpbiAtIGNyZWRpdExlZnRUZXh0LmhlaWdodCkgLyAyKTtcbiAgICAgICAgdG9wLmFkZENoaWxkKGNyZWRpdExlZnRUZXh0KTtcbiAgICB9XG5cbiAgICAvLyBMaXN0ZW4gZm9yIGFuaW1hdGUgdXBkYXRlLlxuICAgIGFwcC50aWNrZXIuYWRkKChkZWx0YSkgPT4ge1xuICAgIC8vIFVwZGF0ZSB0aGUgc2xvdHMuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVlbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSByZWVsc1tpXTtcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBibHVyIGZpbHRlciB5IGFtb3VudCBiYXNlZCBvbiBzcGVlZC5cbiAgICAgICAgICAgIC8vIFRoaXMgd291bGQgYmUgYmV0dGVyIGlmIGNhbGN1bGF0ZWQgd2l0aCB0aW1lIGluIG1pbmQgYWxzby4gTm93IGJsdXIgZGVwZW5kcyBvbiBmcmFtZSByYXRlLlxuICAgICAgICAgICAgci5ibHVyLmJsdXJZID0gKHIucG9zaXRpb24gLSByLnByZXZpb3VzUG9zaXRpb24pICogODtcbiAgICAgICAgICAgIHIucHJldmlvdXNQb3NpdGlvbiA9IHIucG9zaXRpb247XG5cbiAgICAgICAgICAgIC8vIFVwZGF0ZSBzeW1ib2wgcG9zaXRpb25zIG9uIHJlZWwuXG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHIuc3ltYm9scy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSByLnN5bWJvbHNbal07XG4gICAgICAgICAgICAgICAgY29uc3QgcHJldnkgPSBzLnk7XG4gICAgICAgICAgICAgICAgcy55ID0gKChyLnBvc2l0aW9uICsgaikgJSByLnN5bWJvbHMubGVuZ3RoKSAqIFNZTUJPTF9TSVpFIC0gU1lNQk9MX1NJWkU7XG4gICAgICAgICAgICAgICAgaWYgKHMueSA8IDAgJiYgcHJldnkgPiBTWU1CT0xfU0laRSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBEZXRlY3QgZ29pbmcgb3ZlciBhbmQgc3dhcCBhIHRleHR1cmUuXG4gICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgc2hvdWxkIGluIHByb3BlciBwcm9kdWN0IGJlIGRldGVybWluZWQgZnJvbSBzb21lIGxvZ2ljYWwgcmVlbC5cbiAgICAgICAgICAgICAgICAgICAgcy50ZXh0dXJlID0gc2xvdFRleHR1cmVzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHNsb3RUZXh0dXJlcy5sZW5ndGgpXTtcbiAgICAgICAgICAgICAgICAgICAgcy5zY2FsZS54ID0gcy5zY2FsZS55ID0gTWF0aC5taW4oU1lNQk9MX1NJWkUgLyBzLnRleHR1cmUud2lkdGgsIFNZTUJPTF9TSVpFIC8gcy50ZXh0dXJlLmhlaWdodCk7XG4gICAgICAgICAgICAgICAgICAgIHMueCA9IE1hdGgucm91bmQoKFNZTUJPTF9TSVpFIC0gcy53aWR0aCkgLyAyKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coaSwgaiwgcylcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG59XG5cbi8vIFZlcnkgc2ltcGxlIHR3ZWVuaW5nIHV0aWxpdHkgZnVuY3Rpb24uIFRoaXMgc2hvdWxkIGJlIHJlcGxhY2VkIHdpdGggYSBwcm9wZXIgdHdlZW5pbmcgbGlicmFyeSBpbiBhIHJlYWwgcHJvZHVjdC5cbmNvbnN0IHR3ZWVuaW5nOmFueSA9IFtdO1xuZnVuY3Rpb24gdHdlZW5UbyhvYmplY3Q6IGFueSwgcHJvcGVydHk6YW55LCB0YXJnZXQ6YW55LCB0aW1lOmFueSwgZWFzaW5nOmFueSwgb25jaGFuZ2U6YW55LCBvbmNvbXBsZXRlOmFueSkge1xuICAgIGNvbnN0IHR3ZWVuID0ge1xuICAgICAgICBvYmplY3QsXG4gICAgICAgIHByb3BlcnR5LFxuICAgICAgICBwcm9wZXJ0eUJlZ2luVmFsdWU6IG9iamVjdFtwcm9wZXJ0eV0sXG4gICAgICAgIHRhcmdldCxcbiAgICAgICAgZWFzaW5nLFxuICAgICAgICB0aW1lLFxuICAgICAgICBjaGFuZ2U6IG9uY2hhbmdlLFxuICAgICAgICBjb21wbGV0ZTogb25jb21wbGV0ZSxcbiAgICAgICAgc3RhcnQ6IERhdGUubm93KCksXG4gICAgfTtcblxuICAgIHR3ZWVuaW5nLnB1c2godHdlZW4pO1xuICAgIGNvbnNvbGUubG9nKHR3ZWVuKVxuICAgIHJldHVybiB0d2Vlbjtcbn1cbi8vIExpc3RlbiBmb3IgYW5pbWF0ZSB1cGRhdGUuXG5hcHAudGlja2VyLmFkZCgoZGVsdGEpID0+IHtcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IHJlbW92ZSA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdHdlZW5pbmcubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgdCA9IHR3ZWVuaW5nW2ldO1xuICAgICAgICBjb25zdCBwaGFzZSA9IE1hdGgubWluKDEsIChub3cgLSB0LnN0YXJ0KSAvIHQudGltZSk7XG5cbiAgICAgICAgdC5vYmplY3RbdC5wcm9wZXJ0eV0gPSBsZXJwKHQucHJvcGVydHlCZWdpblZhbHVlLCB0LnRhcmdldCwgdC5lYXNpbmcocGhhc2UpKTtcbiAgICAgICAgaWYgKHQuY2hhbmdlKSB0LmNoYW5nZSh0KTtcbiAgICAgICAgaWYgKHBoYXNlID09PSAxKSB7XG4gICAgICAgICAgICB0Lm9iamVjdFt0LnByb3BlcnR5XSA9IHQudGFyZ2V0O1xuICAgICAgICAgICAgaWYgKHQuY29tcGxldGUpIHQuY29tcGxldGUodCk7XG4gICAgICAgICAgICByZW1vdmUucHVzaCh0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlbW92ZS5sZW5ndGg7IGkrKykge1xuICAgICAgICB0d2VlbmluZy5zcGxpY2UodHdlZW5pbmcuaW5kZXhPZihyZW1vdmVbaV0pLCAxKTtcbiAgICB9XG59KTtcblxuLy8gQmFzaWMgbGVycCBmdW50aW9uLlxuZnVuY3Rpb24gbGVycChhMTphbnksIGEyOmFueSwgdDphbnkpIHtcbiAgICByZXR1cm4gYTEgKiAoMSAtIHQpICsgYTIgKiB0O1xufVxuXG4vLyBCYWNrb3V0IGZ1bmN0aW9uIGZyb20gdHdlZW5qcy5cbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9DcmVhdGVKUy9Ud2VlbkpTL2Jsb2IvbWFzdGVyL3NyYy90d2VlbmpzL0Vhc2UuanNcbmZ1bmN0aW9uIGJhY2tvdXQoYW1vdW50Om51bWJlcikge1xuICAgIHJldHVybiAodDphbnkpID0+ICgtLXQgKiB0ICogKChhbW91bnQgKyAxKSAqIHQgKyBhbW91bnQpICsgMSk7XG59Il0sIm1hcHBpbmdzIjoiOztBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFTQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/index.ts\n");

/***/ })

})